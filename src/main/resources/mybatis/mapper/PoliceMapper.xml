<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.sju.program.mapper.PoliceMapper">
    
    <resultMap type="Police" id="PoliceResult">
        <result property="policeId"    column="police_id"    />
        <result property="policeName"    column="police_name"    />
        <result property="policePassword"    column="police_password"    />
        <result property="policeDeleteFlag"    column="police_delete_flag"    />
    </resultMap>

    <sql id="selectPoliceVo">
        select police_id, police_name,police_password, police_delete_flag from police
    </sql>

    <select id="selectPoliceList" parameterType="Police" resultMap="PoliceResult">
        <include refid="selectPoliceVo"/>
        where police_delete_flag != 1
        <!--<where>
        <where>
            <if test="policeName != null  and policeName != ''"> and police_name like concat('%', #{policeName}, '%')</if>
            <if test="policePassword != null  and policePassword != ''"> and police_password = #{policePassword}</if>
            <if test="policeDeleteFlag != null  and policeDeleteFlag != ''"> and police_delete_flag = #{policeDeleteFlag}</if>
            <if test="policeUpdateFlag != null "> and police_update_flag = #{policeUpdateFlag}</if>
        </where>-->
    </select>
    
    <select id="selectPoliceById" parameterType="Long" resultMap="PoliceResult">
        <include refid="selectPoliceVo"/>
        where police_id = #{policeId}
    </select>

    <select id="selectUserByUserName" parameterType="String" resultMap="PoliceResult">
        <include refid="selectPoliceVo"></include>
        WHERE police_name=#{username}
    </select>

    <select id="selectAllPolice" resultMap="PoliceResult">
       select police_name, police_password, police_delete_flag from police
    </select>

    <select id="checkUserNameUnique" parameterType="String" resultType="int">
        SELECT COUNT(1) FROM police WHERE police_name=#{name}
    </select>
        
    <insert id="insertPolice" parameterType="Police" useGeneratedKeys="true" keyProperty="policeId">
        insert into police
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="policeName != null">police_name,</if>
            <if test="policePassword != null">police_password,</if>
            police_delete_flag

         </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="policeName != null">#{policeName},</if>
            <if test="policePassword != null">#{policePassword},</if>
            "live"

         </trim>
    </insert>

    <insert id="saveAllPolices" parameterType="java.util.List">
        INSERT INTO police (police_name, police_password, police_delete_flag) VALUES
        <foreach collection="list" item="item"  separator="," >
            (
            #{item.policeName},#{item.policePassword},"live"
            )
        </foreach>
    </insert>

    <update id="updatePolice" parameterType="Police">
        update police
        <trim prefix="SET" suffixOverrides=",">
            <if test="policeName != null">police_name = #{policeName},</if>
            <if test="policePassword != null">police_password = #{policePassword},</if>
            <if test="policeDeleteFlag != null">police_delete_flag = #{policeDeleteFlag},</if>

        </trim>
        where police_id = #{policeId}
    </update>

    <update id="deletePoliceById" parameterType="Long">
        update police SET police_delete_flag = 1
        where police_id = #{policeId}
    </update>

    <!--<delete id="deletePoliceById" parameterType="Long">
        delete from police where police_id = #{policeId}
    </delete>-->

    <update id="deletePoliceByIds" parameterType="String">
        UPDATE police SET police_delete_flag = 1 where police_id in
        <foreach item="policeId" collection="array" open="(" separator="," close=")">
            #{policeId}
        </foreach>
    </update>
    
</mapper>